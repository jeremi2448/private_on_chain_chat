(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{5340:()=>{},9838:()=>{},8324:(e,s,t)=>{Promise.resolve().then(t.bind(t,1094))},1094:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>w});var a=t(5155),l=t(2115),n=t(582),i=t(8982),r=t(1378),c=t(5237),d=t(6462),o=t(426),x=t(5620),m=t(6745),h=t(1773),p=t(8686),f=t(8283),u=t(2640),g=t(767),b=t(7072);t(7576);var j=t(194);let y=JSON.parse('{"HV":[{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"}],"name":"MessageSent","type":"event"},{"inputs":[{"internalType":"uint256","name":"index","type":"uint256"}],"name":"getMessage","outputs":[{"internalType":"euint64","name":"","type":"bytes32"},{"internalType":"euint64","name":"","type":"bytes32"},{"internalType":"euint64","name":"","type":"bytes32"},{"internalType":"euint64","name":"","type":"bytes32"},{"internalType":"euint32","name":"","type":"bytes32"},{"internalType":"address","name":"","type":"address"},{"internalType":"uint32","name":"","type":"uint32"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getMessageCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_to","type":"address"},{"internalType":"bytes32","name":"_chunk1Handle","type":"bytes32"},{"internalType":"bytes32","name":"_chunk2Handle","type":"bytes32"},{"internalType":"bytes32","name":"_chunk3Handle","type":"bytes32"},{"internalType":"bytes32","name":"_chunk4Handle","type":"bytes32"},{"internalType":"bytes","name":"_inputProof","type":"bytes"},{"internalType":"uint32","name":"_ttl","type":"uint32"}],"name":"sendMessage","outputs":[],"stateMutability":"nonpayable","type":"function"}]}'),N="0xF2c786CEc8CF878c73a8640E3F912831eFdB75c2";function w(){let[e,s]=(0,l.useState)(null),[t,w]=(0,l.useState)([]),[v,k]=(0,l.useState)(0),[S,T]=(0,l.useState)(""),[M,C]=(0,l.useState)(""),[E,A]=(0,l.useState)(!1),[H,_]=(0,l.useState)("Ready"),[I,F]=(0,l.useState)(!1),[D,O]=(0,l.useState)([]),[P,R]=(0,l.useState)({sent:0,received:0,lastMessage:null}),[U,W]=(0,l.useState)(!1),[z,L]=(0,l.useState)(null),B=async()=>{if(!window.ethereum){alert("Please install MetaMask!");return}try{let e=new n.k(window.ethereum),t=await e.send("eth_requestAccounts",[]);s(t[0]),_("Wallet connected");try{let e=await (0,j.Q_)({chainId:0xaa36a7,networkUrl:"https://rpc.sepolia.org",gatewayUrl:"https://gateway.sepolia.zama.ai/"});L(e)}catch(e){console.error("FHE Init Error:",e)}}catch(e){console.error("Connection failed:",e),_("Connection failed")}};(0,l.useEffect)(()=>{{let e=localStorage.getItem("chatStats");if(e){let s=JSON.parse(e);O(s.sentMessages||[]),R(s.stats||{sent:0,received:0,lastMessage:null})}}},[]),(0,l.useEffect)(()=>{localStorage.setItem("chatStats",JSON.stringify({sentMessages:D,stats:P}))},[D,P]);let G=async()=>{if(e)try{let e=new n.k(window.ethereum),s=new i.NZ(N,y.HV,e),t=await s.getMessageCount();k(Number(t)),_("Messages refreshed")}catch(e){console.error("Failed to load messages:",e),_("Failed to load messages")}},J=e=>{let s=e.padEnd(32,"\0").slice(0,32),t=[];for(let e=0;e<4;e++){let a=BigInt(0);for(let t=0;t<8;t++)a|=BigInt(s.charCodeAt(8*e+t))<<BigInt(8*t);t.push(a)}return t},V=e=>r.up(e,32),Q=async()=>{if(!S||!e||!M){_("Please fill all fields");return}if(!c.PW(M)){_("Invalid recipient address");return}if(S.length>32){_("Message too long (max 32 characters)");return}A(!0),F(!0),_("Encrypting message...");try{let s=new n.k(window.ethereum),t=await s.getSigner(),a=new i.NZ(N,y.HV,t),l=J(S),r=l.map(e=>V(e)),c="0x00";try{console.log("Attempting FHE encryption...");let s=(await (0,j.Q_)({chainId:0xaa36a7,networkUrl:"https://rpc.sepolia.org",gatewayUrl:"https://gateway.sepolia.zama.ai/"})).createEncryptedInput(N,e);s.add64(l[0]),s.add64(l[1]),s.add64(l[2]),s.add64(l[3]);let t=await s.encrypt();r=t.handles,c=t.inputProof,console.log("FHE Encryption successful")}catch(e){console.warn("FHE Encryption failed, using fallback to trigger gas fees:",e)}_("Waiting for wallet confirmation..."),console.log("Sending transaction with handles:",r);let d=await a.sendMessage(M,r[0],r[1],r[2],r[3],c,3600,{gasLimit:5e5});_("Transaction sent! Waiting for confirmation..."),await d.wait(),console.log("Message sent to:",M);let o={to:M,content:S,timestamp:new Date().toISOString(),status:"Sent"};O(e=>[o,...e]),R(e=>({...e,sent:e.sent+1,lastMessage:new Date().toISOString()})),_("Message sent successfully!"),T(""),C("")}catch(e){console.error("Send failed:",e),"ACTION_REJECTED"===e.code?_("Transaction rejected by user"):_("Send failed: "+(e.reason||e.message||"Unknown error"))}finally{A(!1),setTimeout(()=>F(!1),500)}};return(0,a.jsxs)("main",{className:"flex min-h-screen flex-col items-center justify-center bg-[#1a1a1a] text-slate-100 p-4 font-sans selection:bg-[#ffd200] selection:text-black",children:[I&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 pointer-events-none flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-fly",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(d.A,{className:"w-24 h-24 text-[#ffd200] drop-shadow-2xl animate-pulse"}),(0,a.jsx)("div",{className:"absolute inset-0 bg-[#ffd200]/20 blur-3xl animate-ping"})]})})}),(0,a.jsxs)("div",{className:"w-full max-w-md bg-[#0f0f0f] rounded-2xl shadow-2xl border border-[#333] overflow-hidden",children:[(0,a.jsxs)("div",{className:"p-6 border-b border-[#333] flex justify-between items-center bg-[#0f0f0f]/50 backdrop-blur-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute -inset-1 bg-[#ffd200]/20 rounded-full blur-sm"}),(0,a.jsx)("img",{src:"/logo.png",alt:"Private Chat Logo",className:"w-10 h-10 object-contain relative z-10"})]}),(0,a.jsxs)("h1",{className:"font-bold text-lg tracking-tight text-white",children:["Private ",(0,a.jsx)("span",{className:"text-[#ffd200]",children:"Chat"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>W(!0),className:"p-2 rounded-full hover:bg-[#222] transition-colors text-slate-400 hover:text-[#ffd200]",title:"Help",children:(0,a.jsx)(o.A,{className:"w-5 h-5"})}),(0,a.jsxs)("button",{onClick:B,className:"flex items-center gap-2 px-4 py-2 rounded-full text-sm font-bold transition-all ".concat(e?"bg-[#ffd200]/10 text-[#ffd200] border border-[#ffd200]/20":"bg-[#ffd200] hover:bg-[#e6bd00] text-black shadow-lg shadow-[#ffd200]/20"),children:[(0,a.jsx)(x.A,{className:"w-4 h-4"}),e?"".concat(e.slice(0,6),"...").concat(e.slice(-4)):"Connect Wallet"]})]})]}),(0,a.jsxs)("div",{className:"px-6 py-2 bg-[#0a0a0a] text-xs text-slate-400 flex justify-between items-center border-b border-[#333]",children:[(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[(0,a.jsx)(m.A,{className:"w-3 h-3 text-[#ffd200]"}),(0,a.jsx)("span",{className:H.includes("failed")?"text-red-400":"text-[#ffd200]",children:H})]}),(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)("span",{className:"w-2 h-2 rounded-full bg-[#ffd200] animate-pulse"}),"Sepolia Network"]})]}),(0,a.jsx)("div",{className:"px-6 py-4 bg-gradient-to-r from-[#ffd200]/5 to-transparent border-b border-[#333]",children:(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-center",children:[(0,a.jsxs)("div",{className:"p-2 rounded-lg bg-[#1a1a1a] border border-[#333]",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-[#ffd200]",children:P.sent}),(0,a.jsx)("p",{className:"text-xs text-slate-400 mt-1 uppercase tracking-wider",children:"Sent"})]}),(0,a.jsxs)("div",{className:"p-2 rounded-lg bg-[#1a1a1a] border border-[#333]",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-white",children:P.received}),(0,a.jsx)("p",{className:"text-xs text-slate-400 mt-1 uppercase tracking-wider",children:"Received"})]}),(0,a.jsxs)("div",{className:"p-2 rounded-lg bg-[#1a1a1a] border border-[#333]",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-slate-400",children:P.sent+P.received}),(0,a.jsx)("p",{className:"text-xs text-slate-400 mt-1 uppercase tracking-wider",children:"Total"})]})]})}),(0,a.jsxs)("div",{className:"h-[400px] overflow-y-auto p-6 space-y-4 bg-[#0a0a0a]",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h3",{className:"text-sm font-bold text-slate-300 flex items-center gap-2 uppercase tracking-wider",children:[(0,a.jsx)(d.A,{className:"w-4 h-4 text-[#ffd200]"}),"Inbox"]}),(0,a.jsxs)("button",{onClick:G,className:"text-xs text-[#ffd200] hover:text-[#e6bd00] transition-colors flex items-center gap-1",disabled:!e,children:[(0,a.jsx)(h.A,{className:"w-3 h-3"})," Refresh"]})]}),e?0===v?(0,a.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-slate-500 gap-2",children:[(0,a.jsx)(d.A,{className:"w-8 h-8 opacity-20"}),(0,a.jsx)("p",{className:"text-sm",children:"No messages received yet"})]}):(0,a.jsx)("div",{className:"bg-[#1a1a1a] p-4 rounded-lg border border-[#333]",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-slate-200",children:"Messages Received"}),(0,a.jsxs)("p",{className:"text-xs text-slate-400 mt-1",children:["You have ",v," message",v>1?"s":""]})]}),(0,a.jsx)("div",{className:"bg-[#ffd200]/20 px-3 py-1 rounded-full border border-[#ffd200]/20",children:(0,a.jsx)("span",{className:"text-[#ffd200] font-bold",children:v})})]})}):(0,a.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-slate-500 gap-2",children:[(0,a.jsx)(p.A,{className:"w-8 h-8 opacity-20"}),(0,a.jsx)("p",{className:"text-sm",children:"Connect wallet to view messages"})]})]}),(0,a.jsxs)("div",{className:"max-h-[300px] overflow-y-auto p-6 space-y-3 bg-[#111] border-t border-[#333]",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("h3",{className:"text-sm font-bold text-slate-300 flex items-center gap-2 uppercase tracking-wider",children:[(0,a.jsx)(f.A,{className:"w-4 h-4 text-[#ffd200]"}),"Sent Messages"]}),(0,a.jsxs)("span",{className:"text-xs text-slate-500",children:[D.length," total"]})]}),0===D.length?(0,a.jsx)("div",{className:"text-center py-8 text-slate-500",children:(0,a.jsx)("p",{className:"text-sm",children:"No messages sent"})}):(0,a.jsx)("div",{className:"space-y-2",children:D.slice(0,5).map((e,s)=>(0,a.jsx)("div",{className:"bg-[#1a1a1a] p-3 rounded-lg border border-[#333] hover:border-[#ffd200]/50 transition-colors group",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("p",{className:"text-xs text-slate-400 mb-1 group-hover:text-[#ffd200] transition-colors",children:["To: ",e.to.slice(0,6),"...",e.to.slice(-4)]}),(0,a.jsx)("p",{className:"text-sm text-slate-200 truncate",children:e.content})]}),(0,a.jsxs)("div",{className:"text-right ml-2",children:[(0,a.jsxs)("p",{className:"text-xs text-[#ffd200]",children:["✓ ",e.status]}),(0,a.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:new Date(e.timestamp).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})})]})]})},s))})]}),(0,a.jsxs)("div",{className:"p-4 bg-[#0f0f0f] border-t border-[#333]",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("input",{type:"text",value:M,onChange:e=>C(e.target.value),placeholder:"Recipient address (0x...)",className:"w-full bg-[#1a1a1a] border border-[#333] rounded-xl px-4 py-3 text-sm focus:outline-none focus:border-[#ffd200] focus:ring-1 focus:ring-[#ffd200] transition-all placeholder:text-slate-600 text-white",disabled:!e||E}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"text",value:S,onChange:e=>T(e.target.value),placeholder:"Type your message (max 32 chars)...",className:"flex-1 bg-[#1a1a1a] border border-[#333] rounded-xl px-4 py-3 text-sm focus:outline-none focus:border-[#ffd200] focus:ring-1 focus:ring-[#ffd200] transition-all placeholder:text-slate-600 text-white",disabled:!e||E,maxLength:32}),(0,a.jsx)("button",{onClick:Q,disabled:!e||E,className:"bg-[#ffd200] hover:bg-[#e6bd00] disabled:opacity-50 disabled:cursor-not-allowed text-black font-bold p-3 rounded-xl transition-all shadow-lg shadow-[#ffd200]/20",children:E?(0,a.jsx)(h.A,{className:"w-5 h-5 animate-spin"}):(0,a.jsx)(f.A,{className:"w-5 h-5"})})]})]}),(0,a.jsxs)("p",{className:"text-xs text-slate-500 mt-2 text-center flex items-center justify-center gap-1",children:[(0,a.jsx)(u.A,{className:"w-3 h-3"}),"Messages are encrypted end-to-end using FHE."]})]})]}),U&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4 backdrop-blur-sm",onClick:()=>W(!1),children:(0,a.jsxs)("div",{className:"bg-[#0f0f0f] rounded-2xl border border-[#333] max-w-2xl w-full max-h-[80vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"sticky top-0 bg-[#0f0f0f] border-b border-[#333] p-6 flex justify-between items-center",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold flex items-center gap-2 text-white",children:[(0,a.jsx)(o.A,{className:"w-6 h-6 text-[#ffd200]"}),"User Guide"]}),(0,a.jsx)("button",{onClick:()=>W(!1),className:"p-2 hover:bg-[#222] rounded-lg transition-colors text-slate-400",children:(0,a.jsx)(g.A,{className:"w-5 h-5"})})]}),(0,a.jsxs)("div",{className:"p-6 space-y-6 text-sm",children:[(0,a.jsxs)("section",{children:[(0,a.jsxs)("h3",{className:"font-bold text-lg mb-3 text-[#ffd200] flex items-center gap-2",children:[(0,a.jsx)(b.A,{className:"w-4 h-4"})," Quick Start"]}),(0,a.jsxs)("ol",{className:"space-y-2 list-decimal list-inside text-slate-300",children:[(0,a.jsx)("li",{children:'Click "Connect Wallet" to connect MetaMask'}),(0,a.jsx)("li",{children:"Ensure you are on the Sepolia network"}),(0,a.jsx)("li",{children:"Get free Sepolia ETH from a faucet"})]})]}),(0,a.jsxs)("section",{children:[(0,a.jsxs)("h3",{className:"font-bold text-lg mb-3 text-white flex items-center gap-2",children:[(0,a.jsx)(f.A,{className:"w-4 h-4"})," Sending a Message"]}),(0,a.jsxs)("ol",{className:"space-y-2 list-decimal list-inside text-slate-300",children:[(0,a.jsx)("li",{children:"Enter the recipient's Ethereum address (0x...)"}),(0,a.jsx)("li",{children:"Type your message (max 32 chars)"}),(0,a.jsx)("li",{children:"Click Send and confirm in MetaMask"}),(0,a.jsx)("li",{children:"Enjoy the animation! \uD83D\uDC8C"})]})]}),(0,a.jsxs)("section",{children:[(0,a.jsxs)("h3",{className:"font-bold text-lg mb-3 text-white flex items-center gap-2",children:[(0,a.jsx)(m.A,{className:"w-4 h-4"})," Statistics"]}),(0,a.jsx)("p",{className:"text-slate-300 mb-2",children:"The dashboard displays:"}),(0,a.jsxs)("ul",{className:"space-y-1 list-disc list-inside text-slate-400",children:[(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{className:"text-[#ffd200]",children:"Sent"}),": Messages you have sent"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{className:"text-white",children:"Received"}),": Messages received (click \uD83D\uDD04 to refresh)"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{className:"text-slate-400",children:"Total"}),": Sum of both"]})]})]}),(0,a.jsxs)("section",{children:[(0,a.jsxs)("h3",{className:"font-bold text-lg mb-3 text-[#ffd200] flex items-center gap-2",children:[(0,a.jsx)(u.A,{className:"w-4 h-4"})," Privacy"]}),(0,a.jsxs)("p",{className:"text-slate-300",children:["Your messages are encrypted with ",(0,a.jsx)("strong",{children:"FHE (Fully Homomorphic Encryption)"}),". Only you and the recipient can read them!"]})]}),(0,a.jsxs)("section",{className:"bg-[#1a1a1a] p-4 rounded-lg border border-[#333]",children:[(0,a.jsx)("h3",{className:"font-bold mb-2 text-red-400",children:"⚠️ Important"}),(0,a.jsxs)("ul",{className:"space-y-1 list-disc list-inside text-slate-400 text-xs",children:[(0,a.jsx)("li",{children:"Maximum 32 characters per message"}),(0,a.jsx)("li",{children:"Verify address before sending (irreversible)"}),(0,a.jsx)("li",{children:"Gas fees apply (Sepolia ETH)"})]})]}),(0,a.jsx)("div",{className:"text-center pt-4 border-t border-[#333]",children:(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"For more details, check TUTORIAL.md on GitHub"})})]})]})})]})}},7576:()=>{}},e=>{var s=s=>e(e.s=s);e.O(0,[185,529,809,441,517,358],()=>s(8324)),_N_E=e.O()}]);